
# Gyulist - ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç§»è¡Œãƒ«ãƒ¼ãƒ«

## ğŸš€ ç§»è¡Œä½œæ¥­ã®åŸºæœ¬åŸå‰‡

### ç§»è¡Œã®ç›®çš„
- ç¾åœ¨ã®`contexts/[domain]/`æ§‹é€ ã‹ã‚‰ã€é–¢æ•°å‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒªãƒ³ã‚° + ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¸ã®æ®µéšçš„ç§»è¡Œ
- è²¬å‹™ã®æ˜ç¢ºåŒ–ã¨ä¾å­˜é–¢ä¿‚ã®æ•´ç†
- ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ã¨ä¿å®ˆæ€§ã®å‘ä¸Š

### ç§»è¡Œã®åŸºæœ¬æ–¹é‡
1. **æ®µéšçš„ç§»è¡Œ**: ä¸€åº¦ã«å…¨ã¦ã‚’å¤‰æ›´ã›ãšã€æ®µéšçš„ã«ç§»è¡Œ
2. **æ—¢å­˜æ©Ÿèƒ½ã®ç¶­æŒ**: ç§»è¡Œä¸­ã‚‚æ—¢å­˜ã®APIãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ä¿è¨¼
3. **ãƒ†ã‚¹ãƒˆé§†å‹•**: å„ãƒ•ã‚§ãƒ¼ã‚ºå¾Œã«ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨ã‚’ç¢ºèª
4. **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æº–å‚™**: å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ã‚’æº–å‚™

## ğŸ“ æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

### ç›®æ¨™æ§‹é€ 
```
apps/api/src/
â”œâ”€â”€ domain/              # ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆç´”ç²‹é–¢æ•°ï¼‰
â”‚   â”œâ”€â”€ types/           # ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒ—ï¼ˆãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼‰
â”‚   â”œâ”€â”€ functions/       # ç´”ç²‹é–¢æ•°ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
â”‚   â”œâ”€â”€ workflows/       # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆé–¢æ•°ã®çµ„ã¿åˆã‚ã›ï¼‰
â”‚   â”œâ”€â”€ errors/          # ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ï¼ˆUnionå‹ï¼‰
â”‚   â””â”€â”€ ports/           # ãƒãƒ¼ãƒˆå®šç¾©ï¼ˆé–¢æ•°å‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰
â”œâ”€â”€ application/         # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼‰
â”‚   â”œâ”€â”€ use-cases/       # ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼ˆé–¢æ•°ï¼‰
â”‚   â”œâ”€â”€ commands/        # ã‚³ãƒãƒ³ãƒ‰å‹å®šç¾©
â”‚   â”œâ”€â”€ queries/         # ã‚¯ã‚¨ãƒªå‹å®šç¾©
â”‚   â””â”€â”€ dto/             # DTOï¼ˆå…¥å‡ºåŠ›å¤‰æ›ï¼‰
â”œâ”€â”€ infrastructure/      # ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ï¼ˆå‰¯ä½œç”¨ï¼‰
â”‚   â”œâ”€â”€ database/        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®Ÿè£…
â”‚   â”œâ”€â”€ external/        # å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”œâ”€â”€ services/        # ã‚¤ãƒ³ãƒ•ãƒ©ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â””â”€â”€ config/          # è¨­å®šç®¡ç†
â”œâ”€â”€ interfaces/          # ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ï¼ˆHTTP/APIï¼‰
â”‚   â”œâ”€â”€ http/            # HTTPå±¤
â”‚   â””â”€â”€ batch/           # ãƒãƒƒãƒå‡¦ç†
â””â”€â”€ shared/              # å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆç§»è¡Œä¸­ã¯ç¶­æŒï¼‰
```

## ğŸ”„ ç§»è¡Œãƒ•ã‚§ãƒ¼ã‚º

### Phase 1: åŸºç›¤æ•´å‚™ï¼ˆ1-2é€±é–“ï¼‰
- [ ] æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ä½œæˆ
- [ ] å…±é€šå‹ã®ç§»è¡Œï¼ˆResult, Brandå‹ãªã©ï¼‰
- [ ] ä¾å­˜æ³¨å…¥åŸºç›¤ã®æº–å‚™
- [ ] ç§»è¡Œè¨ˆç”»ã®è©³ç´°åŒ–

### Phase 2: ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ç§»è¡Œï¼ˆ2-3é€±é–“ï¼‰
- [ ] ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒ—ã®ç§»è¡Œ
- [ ] ç´”ç²‹é–¢æ•°ã®ç§»è¡Œ
- [ ] ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ä½œæˆ
- [ ] ã‚¨ãƒ©ãƒ¼å®šç¾©ã®æ•´ç†

### Phase 3: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ç§»è¡Œï¼ˆ2-3é€±é–“ï¼‰
- [ ] ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®ç§»è¡Œ
- [ ] DTOã¨ãƒãƒƒãƒ‘ãƒ¼ã®ä½œæˆ
- [ ] ã‚³ãƒãƒ³ãƒ‰ãƒ»ã‚¯ã‚¨ãƒªã®å®šç¾©
- [ ] ä¾å­˜é–¢ä¿‚ã®æ•´ç†

### Phase 4: ã‚¤ãƒ³ãƒ•ãƒ©å±¤ç§»è¡Œï¼ˆ2-3é€±é–“ï¼‰
- [ ] ãƒªãƒã‚¸ãƒˆãƒªã®ç§»è¡Œ
- [ ] ãƒãƒƒãƒ‘ãƒ¼ã®ç§»è¡Œ
- [ ] å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®ç§»è¡Œ
- [ ] è¨­å®šç®¡ç†ã®æ•´ç†

### Phase 5: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ç§»è¡Œï¼ˆ1-2é€±é–“ï¼‰
- [ ] ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ç§»è¡Œ
- [ ] ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ç§»è¡Œ
- [ ] ãƒ«ãƒ¼ãƒˆå®šç¾©ã®ç§»è¡Œ
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çµ±ä¸€

### Phase 6: ãƒ†ã‚¹ãƒˆãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼ˆ1-2é€±é–“ï¼‰
- [ ] ãƒ†ã‚¹ãƒˆã®ç§»è¡Œ
- [ ] ä¾å­˜æ³¨å…¥ã®è¨­å®š
- [ ] ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ›´æ–°
- [ ] æœ€çµ‚å‹•ä½œç¢ºèª

## ğŸ“‹ ç§»è¡Œä½œæ¥­ã®ãƒ«ãƒ¼ãƒ«

### 1. ãƒ•ã‚¡ã‚¤ãƒ«ç§»è¡Œãƒ«ãƒ¼ãƒ«

#### ç§»è¡Œå…ƒã¨ç§»è¡Œå…ˆã®å¯¾å¿œï¼ˆç¾è¡Œæ§‹é€ ã«åŸºã¥ãï¼‰
```typescript
// ç§»è¡Œå…ƒ: apps/api/src/contexts/cattle/domain/model/cattle.ts
// ç§»è¡Œå…ˆ: apps/api/src/domain/types/cattle/Cattle.ts

// ç§»è¡Œå…ƒ: apps/api/src/contexts/cattle/domain/services/createCattle.ts
// ç§»è¡Œå…ˆ: apps/api/src/application/use-cases/cattle/createCattle.ts

// ç§»è¡Œå…ƒ: apps/api/src/contexts/cattle/infra/drizzle/repo.ts
// ç§»è¡Œå…ˆ: apps/api/src/infrastructure/database/repositories/CattleRepository.ts

// ç§»è¡Œå…ƒ: apps/api/src/contexts/cattle/infra/mappers/dbToDomain.ts
// ç§»è¡Œå…ˆ: apps/api/src/infrastructure/database/mappers/cattleDbMapper.ts

// ç§»è¡Œå…ƒ: apps/api/src/contexts/cattle/domain/codecs/input.ts
// ç§»è¡Œå…ˆ: apps/api/src/application/dto/types/CattleDto.ts

// ç§»è¡Œå…ƒ: apps/api/src/contexts/cattle/domain/codecs/output.ts
// ç§»è¡Œå…ˆ: apps/api/src/application/dto/types/CattleResponse.ts

// ç§»è¡Œå…ƒ: apps/api/src/routes/cattle.ts
// ç§»è¡Œå…ˆ: apps/api/src/interfaces/http/controllers/CattleController.ts

// ç§»è¡Œå…ƒ: apps/api/src/shared/config/di.ts
// ç§»è¡Œå…ˆ: apps/api/src/infrastructure/config/dependencies.ts
```

#### ãƒ•ã‚¡ã‚¤ãƒ«åã®å¤‰æ›´ãƒ«ãƒ¼ãƒ«
- **ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£**: `cattle.ts` â†’ `Cattle.ts`ï¼ˆPascalCaseï¼‰
- **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**: `createCattle.ts` â†’ `createCattle.ts`ï¼ˆcamelCaseï¼‰
- **ãƒªãƒã‚¸ãƒˆãƒª**: `repo.ts` â†’ `CattleRepository.ts`ï¼ˆPascalCaseï¼‰
- **ãƒãƒƒãƒ‘ãƒ¼**: `dbToDomain.ts` â†’ `cattleDbMapper.ts`ï¼ˆcamelCaseï¼‰
- **ã‚³ãƒ¼ãƒ‡ãƒƒã‚¯**: `input.ts` â†’ `CattleDto.ts`ï¼ˆPascalCaseï¼‰
- **ãƒ«ãƒ¼ãƒˆ**: `cattle.ts` â†’ `CattleController.ts`ï¼ˆPascalCaseï¼‰

### 2. ã‚³ãƒ¼ãƒ‰ç§»è¡Œãƒ«ãƒ¼ãƒ«

#### ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ç§»è¡Œï¼ˆç¾è¡Œã®ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‹ã‚‰é–¢æ•°å‹ã¸ï¼‰
```typescript
// âœ… ç§»è¡Œå‰: ç¾è¡Œã®ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ï¼ˆä¸å¤‰ãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼‰
export type Cattle = {
  readonly cattleId: CattleId;
  readonly ownerUserId: UserId;
  readonly identificationNumber: IdentificationNumber;
  readonly name: CattleName | null;
  readonly gender: Gender | null;
  readonly birthday: Date | null;
  // ... ãã®ä»–ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
};

// âœ… ç§»è¡Œå¾Œ: é–¢æ•°å‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒªãƒ³ã‚°
export type Cattle = Readonly<{
  id: CattleId;
  ownerUserId: UserId;
  identificationNumber: IdentificationNumber;
  name: NonEmptyString | null;
  gender: CattleGender | null;
  birthDate: Date | null;
  // ... ãã®ä»–ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
}>;

export const updateCattleName = (
  cattle: Cattle, 
  newName: string
): Result<Cattle, ValidationError> => {
  const validation = validateCattleName(newName);
  if (!validation.ok) return validation;
  
  return ok({
    ...cattle,
    name: validation.value,
    updatedAt: new Date()
  });
};
```

#### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®ç§»è¡Œï¼ˆç¾è¡Œã®é–¢æ•°å‹ã‹ã‚‰å‹å®‰å…¨æ€§å‘ä¸Šã¸ï¼‰
```typescript
// âœ… ç§»è¡Œå‰: ç¾è¡Œã®é–¢æ•°å‹
export const create = (deps: Deps) => async (cmd: CreateCattleCmd): Promise<Result<Cattle, DomainError>> => {
  // å®Ÿè£…
};

// âœ… ç§»è¡Œå¾Œ: é–¢æ•°å‹ï¼ˆå‹å®šç¾©ã‚’æ˜ç¢ºåŒ–ï¼‰
export type CreateCattleUseCase = (
  deps: CreateCattleDeps
) => (
  input: CreateCattleInput
) => Promise<Result<Cattle, CreateCattleError>>;

export const createCattle: CreateCattleUseCase = (deps) => async (input) => {
  // å®Ÿè£…
};
```

#### ãƒªãƒã‚¸ãƒˆãƒªã®ç§»è¡Œï¼ˆç¾è¡Œã®makeCattleRepoã‹ã‚‰makeCattleRepositoryã¸ï¼‰
```typescript
// âœ… ç§»è¡Œå‰: ç¾è¡Œã®é–¢æ•°å‹ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼
export function makeCattleRepo(db: AnyD1Database): CattleRepoPort {
  return {
    async findById(id: CattleId) {
      // å®Ÿè£…
    }
  };
}

// âœ… ç§»è¡Œå¾Œ: é–¢æ•°å‹ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ï¼ˆå‹å®‰å…¨æ€§å‘ä¸Šï¼‰
export const makeCattleRepository = (db: Database): CattleRepository => ({
  async findById(id: CattleId): Promise<Option<Cattle>> {
    try {
      const row = await db.selectFrom('cattle')
        .where('id', '=', id)
        .selectAll()
        .executeTakeFirst();
      
      return row ? some(cattleDbMapper.toDomain(row)) : none;
    } catch (error) {
      throw new InfrastructureError('Database query failed', error);
    }
  }
});
```

#### ãƒãƒƒãƒ‘ãƒ¼ã®ç§»è¡Œï¼ˆç¾è¡Œã®å€‹åˆ¥é–¢æ•°ã‹ã‚‰çµ±ä¸€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ï¼‰
```typescript
// âœ… ç§»è¡Œå‰: ç¾è¡Œã®å€‹åˆ¥é–¢æ•°
export function toDomain(row: InferSelectModel<typeof CattleTable>): DomainCattle {
  // å®Ÿè£…
}

export function toDbInsert(cattle: NewCattleProps): InsertCattle {
  // å®Ÿè£…
}

// âœ… ç§»è¡Œå¾Œ: çµ±ä¸€ã•ã‚ŒãŸãƒãƒƒãƒ‘ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
export const cattleDbMapper = {
  toDomain: (row: CattleRow): Cattle => ({
    id: row.cattleId as CattleId,
    ownerUserId: row.ownerUserId as UserId,
    identificationNumber: row.identificationNumber as IdentificationNumber,
    // ... ãã®ä»–ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
  }),

  toDb: (cattle: Cattle): CattleRow => ({
    cattleId: cattle.id,
    ownerUserId: cattle.ownerUserId,
    identificationNumber: cattle.identificationNumber,
    // ... ãã®ä»–ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
  }),

  toDbInsert: (cattle: CreateCattleInput): InsertCattle => ({
    // ... å®Ÿè£…
  })
};
```

### 3. ä¾å­˜é–¢ä¿‚ã®ç§»è¡Œãƒ«ãƒ¼ãƒ«

#### ä¾å­˜æ³¨å…¥ã®è¨­å®šï¼ˆç¾è¡Œã®makeDepsã‹ã‚‰makeDependenciesã¸ï¼‰
```typescript
// âœ… ç§»è¡Œå‰: ç¾è¡Œã®å€‹åˆ¥DIè¨­å®š
export function makeDeps(db: AnyD1Database, clock: ClockPort): CoreDeps {
  return {
    get cattleRepo() {
      return makeCattleRepo(db);
    },
    get eventsRepo() {
      return makeEventsRepo(db);
    },
    // ... ãã®ä»–ã®ä¾å­˜é–¢ä¿‚
    clock
  };
}

// âœ… ç§»è¡Œå¾Œ: çµ±ä¸€DIè¨­å®š
export const makeDependencies = (env: Environment): Dependencies => {
  const database = createDatabase(env.DATABASE_URL);
  const clock = createClock();
  const idGenerator = createIdGenerator();
  
  const cattleRepo = makeCattleRepository(database);
  const eventsRepo = makeEventsRepository(database);
  
  const createCattleUseCase = createCattle({
    cattleRepo,
    clock,
    idGenerator
  });
  
  return {
    repositories: { cattleRepo, eventsRepo },
    useCases: { createCattleUseCase },
    services: { clock, idGenerator }
  };
};
```

### 4. ãƒ«ãƒ¼ãƒˆãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ç§»è¡Œ

#### ç¾è¡Œã®ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã¸ã®ç§»è¡Œ
```typescript
// âœ… ç§»è¡Œå‰: ç¾è¡Œã®ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
// apps/api/src/routes/cattle.ts
const app = new Hono<{ Bindings: Bindings }>()
  .use("*", jwtMiddleware)
  .get("/", zValidator("query", searchCattleSchema), async (c) => {
    // å®Ÿè£…
  })
  .post("/", zValidator("json", createCattleSchema), async (c) => {
    // å®Ÿè£…
  });

// âœ… ç§»è¡Œå¾Œ: ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ + ãƒ«ãƒ¼ãƒˆå®šç¾©
// apps/api/src/interfaces/http/controllers/CattleController.ts
export const makeCattleController = (deps: ControllerDeps) => ({
  async search(c: Context): Promise<Response> {
    // å®Ÿè£…
  },
  
  async create(c: Context): Promise<Response> {
    // å®Ÿè£…
  }
});

// apps/api/src/interfaces/http/routes/cattle.ts
export const createCattleRoutes = (deps: Dependencies) => {
  const controller = makeCattleController(deps);
  
  return (app: Hono) => {
    app.get('/cattle', async (c) => controller.search(c));
    app.post('/cattle', async (c) => controller.create(c));
  };
};
```

### 5. ãƒ†ã‚¹ãƒˆç§»è¡Œãƒ«ãƒ¼ãƒ«

#### ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œï¼ˆç¾è¡Œã®__tests__æ§‹é€ ã‹ã‚‰æ–°ã—ã„æ§‹é€ ã¸ï¼‰
```typescript
// âœ… ç§»è¡Œå‰: ç¾è¡Œã®ãƒ†ã‚¹ãƒˆæ§‹é€ 
// apps/api/src/contexts/cattle/__tests__/unit/createCattle.test.ts

// âœ… ç§»è¡Œå¾Œ: æ–°ã—ã„ãƒ†ã‚¹ãƒˆæ§‹é€ 
// apps/api/src/domain/functions/cattle/__tests__/cattleValidation.test.ts
// apps/api/src/application/use-cases/cattle/__tests__/createCattle.test.ts
// apps/api/src/infrastructure/database/repositories/__tests__/CattleRepository.test.ts
```

#### ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ã®çµ±ä¸€
```typescript
// âœ… ç§»è¡Œå¾Œ: çµ±ä¸€ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼
export const createMockCattle = (overrides: Partial<Cattle> = {}): Cattle => ({
  id: 1 as CattleId,
  ownerUserId: 1 as UserId,
  identificationNumber: 12345 as IdentificationNumber,
  name: 'Test Cattle' as NonEmptyString,
  gender: 'FEMALE' as CattleGender,
  birthDate: new Date('2020-01-01'),
  status: 'HEALTHY' as CattleStatus,
  createdAt: new Date('2020-01-01'),
  updatedAt: new Date('2020-01-01'),
  ...overrides
});

export const createMockCattleRepository = (): CattleRepository => ({
  findById: vi.fn(),
  save: vi.fn(),
  existsByIdentificationNumber: vi.fn(),
  // ... ãã®ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰
});
```

## ğŸš« ç§»è¡Œä¸­ã®ç¦æ­¢äº‹é …

### 1. ä¸€åº¦ã«å…¨ã¦ã‚’å¤‰æ›´ã—ãªã„
- âŒ å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒæ™‚ã«ç§»è¡Œ
- âŒ è¤‡æ•°ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’åŒæ™‚ã«ç§»è¡Œ
- âŒ ç§»è¡Œä¸­ã«æ–°æ©Ÿèƒ½ã‚’è¿½åŠ 

### 2. æ—¢å­˜ã®APIã‚’å£Šã•ãªã„
- âŒ æ—¢å­˜ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å¤‰æ›´
- âŒ æ—¢å­˜ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã®å¤‰æ›´
- âŒ æ—¢å­˜ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã®å¤‰æ›´

### 3. ãƒ†ã‚¹ãƒˆã‚’ç„¡è¦–ã—ãªã„
- âŒ ãƒ†ã‚¹ãƒˆãŒé€šã‚‰ãªã„çŠ¶æ…‹ã§ã®æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œ
- âŒ ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤
- âŒ ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã®ä½ä¸‹

## âœ… ç§»è¡Œå®Œäº†ã®ç¢ºèªäº‹é …

### 1. æ§‹é€ ã®ç¢ºèª
- [ ] æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãŒå®Œæˆã—ã¦ã„ã‚‹
- [ ] å¤ã„`contexts/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå‰Šé™¤ã•ã‚Œã¦ã„ã‚‹
- [ ] å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒé©åˆ‡ãªå ´æ‰€ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹

### 2. æ©Ÿèƒ½ã®ç¢ºèª
- [ ] æ—¢å­˜ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå‹•ä½œã—ã¦ã„ã‚‹
- [ ] æ–°æ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒçµ±ä¸€ã•ã‚Œã¦ã„ã‚‹

### 3. å“è³ªã®ç¢ºèª
- [ ] å…¨ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã£ã¦ã„ã‚‹
- [ ] å‹ãƒã‚§ãƒƒã‚¯ãŒé€šã£ã¦ã„ã‚‹
- [ ] ãƒªãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ãŒãªã„
- [ ] ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒç¶­æŒã•ã‚Œã¦ã„ã‚‹

### 4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ›´æ–°
- [ ] APIä»•æ§˜æ›¸ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- [ ] é–‹ç™ºè€…å‘ã‘ã‚¬ã‚¤ãƒ‰ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹

## ğŸ”§ ç§»è¡Œä½œæ¥­ã®ãƒ„ãƒ¼ãƒ«ãƒ»ã‚³ãƒãƒ³ãƒ‰

### 1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
```bash
# æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’ä½œæˆ
mkdir -p apps/api/src/{domain,application,infrastructure,interfaces}
mkdir -p apps/api/src/domain/{types,functions,workflows,errors,ports}
mkdir -p apps/api/src/application/{use-cases,commands,queries,dto}
mkdir -p apps/api/src/infrastructure/{database,external,services,config}
mkdir -p apps/api/src/interfaces/{http,batch}
```

### 2. ãƒ•ã‚¡ã‚¤ãƒ«ç§»è¡Œï¼ˆç¾è¡Œæ§‹é€ ã«åŸºã¥ãï¼‰
```bash
# æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°ã—ã„å ´æ‰€ã«ã‚³ãƒ”ãƒ¼ï¼ˆä¸€æ™‚çš„ã«ï¼‰
cp -r apps/api/src/contexts/cattle/domain/* apps/api/src/domain/types/cattle/
cp -r apps/api/src/contexts/cattle/infra/* apps/api/src/infrastructure/database/cattle/
cp -r apps/api/src/routes/* apps/api/src/interfaces/http/
cp -r apps/api/src/shared/* apps/api/src/domain/
```

### 3. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# å„ãƒ•ã‚§ãƒ¼ã‚ºå¾Œã«ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
pnpm test:run

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œ
pnpm test:run apps/api/src/domain/functions/cattle/
```

### 4. å‹ãƒã‚§ãƒƒã‚¯
```bash
# TypeScriptå‹ãƒã‚§ãƒƒã‚¯
pnpm build

# å‹ãƒã‚§ãƒƒã‚¯ã®ã¿
pnpm type-check
```

## ğŸ“ ç§»è¡Œä½œæ¥­ã®è¨˜éŒ²

### ç§»è¡Œãƒ­ã‚°ã®è¨˜éŒ²é …ç›®
1. **ç§»è¡Œæ—¥æ™‚**: å„ãƒ•ã‚§ãƒ¼ã‚ºã®é–‹å§‹ãƒ»å®Œäº†æ—¥æ™‚
2. **ç§»è¡Œå¯¾è±¡**: ç§»è¡Œã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
3. **å¤‰æ›´å†…å®¹**: å…·ä½“çš„ãªå¤‰æ›´å†…å®¹
4. **å•é¡Œç‚¹**: ç™ºç”Ÿã—ãŸå•é¡Œã¨ãã®è§£æ±ºæ–¹æ³•
5. **ç¢ºèªäº‹é …**: å‹•ä½œç¢ºèªã®çµæœ
6. **æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚ºã®æº–å‚™çŠ¶æ³

### ç§»è¡Œãƒ­ã‚°ã®è¨˜éŒ²æ–¹æ³•
```markdown
## Phase X: [ãƒ•ã‚§ãƒ¼ã‚ºå] - [æ—¥ä»˜]

### ç§»è¡Œå¯¾è±¡
- [ãƒ•ã‚¡ã‚¤ãƒ«å] â†’ [æ–°ã—ã„å ´æ‰€]

### å¤‰æ›´å†…å®¹
- å…·ä½“çš„ãªå¤‰æ›´å†…å®¹

### å•é¡Œç‚¹
- ç™ºç”Ÿã—ãŸå•é¡Œã¨è§£æ±ºæ–¹æ³•

### ç¢ºèªäº‹é …
- ãƒ†ã‚¹ãƒˆçµæœ
- å‹•ä½œç¢ºèªçµæœ

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
- æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚ºã®æº–å‚™çŠ¶æ³
```

## ğŸš¨ ç·Šæ€¥æ™‚ã®å¯¾å¿œ

### å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆ
1. **å³åº§ã«ä½œæ¥­ã‚’åœæ­¢**
2. **å•é¡Œã®è©³ç´°ã‚’è¨˜éŒ²**
3. **ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã«å ±å‘Š**
4. **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ã‚’å®Ÿè¡Œ**
5. **å•é¡Œã®åŸå› ã‚’ç‰¹å®š**
6. **è§£æ±ºç­–ã‚’æ¤œè¨**
7. **ç§»è¡Œè¨ˆç”»ã‚’è¦‹ç›´ã—**

### ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †
```bash
# 1. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦ã„ãªã„å ´åˆ
git reset --hard HEAD

# 2. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦ã„ã‚‹å ´åˆ
git revert [ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥]

# 3. æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤
rm -rf apps/api/src/{domain,application,infrastructure,interfaces}

# 4. æ—¢å­˜ã®æ§‹é€ ã‚’å¾©å…ƒ
git checkout HEAD -- apps/api/src/contexts/
```

## ğŸ” ç¾è¡Œã‚³ãƒ¼ãƒ‰ã®ç‰¹å¾´ã¨ç§»è¡Œæ™‚ã®æ³¨æ„ç‚¹

### ç¾è¡Œã‚³ãƒ¼ãƒ‰ã®ç‰¹å¾´
1. **æ—¢ã«é–¢æ•°å‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã®ä¸€éƒ¨ã‚’æ¡ç”¨**
   - `create`é–¢æ•°ã«ã‚ˆã‚‹ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å®Ÿè£…
   - `Result`å‹ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
   - `Brand`å‹ã«ã‚ˆã‚‹å‹å®‰å…¨æ€§

2. **æ®µéšçš„ãªç§»è¡ŒãŒå¯èƒ½**
   - æ—¢å­˜ã®é–¢æ•°å‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ´»ç”¨
   - ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‹ã‚‰é–¢æ•°å‹ã¸ã®å®Œå…¨ç§»è¡Œ
   - ä¾å­˜æ³¨å…¥ã®çµ±ä¸€åŒ–

3. **æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆæ§‹é€ ã‚’æ´»ç”¨**
   - `__tests__`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ§‹é€ ã‚’å‚è€ƒ
   - ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ã®çµ±ä¸€
   - ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã®ç¶­æŒ

4. **Hono RPCã®æ´»ç”¨**
   - `@hono/zod-validator`ã«ã‚ˆã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®å‹å®‰å…¨ãªAPIå‘¼ã³å‡ºã—
   - `AppType`ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã«ã‚ˆã‚‹å‹æ¨è«–

### ç§»è¡Œæ™‚ã®æ³¨æ„ç‚¹
1. **æ—¢å­˜ã®APIå¥‘ç´„ã‚’ç¶­æŒ**
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã®å¤‰æ›´ç¦æ­¢
   - ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å¤‰æ›´ç¦æ­¢
   - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã®å¤‰æ›´ç¦æ­¢

2. **æ®µéšçš„ãªç§»è¡Œã®é‡è¦æ€§**
   - ãƒ‰ãƒ¡ã‚¤ãƒ³ã”ã¨ã®é †æ¬¡ç§»è¡Œ
   - å„ãƒ•ã‚§ãƒ¼ã‚ºã§ã®ãƒ†ã‚¹ãƒˆç¢ºèª
   - ä¾å­˜é–¢ä¿‚ã®æ®µéšçš„æ•´ç†

3. **æ—¢å­˜æ©Ÿèƒ½ã®å‹•ä½œä¿è¨¼**
   - ç§»è¡Œä¸­ã®å‹•ä½œç¢ºèª
   - ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ã®æº–å‚™
   - å•é¡Œç™ºç”Ÿæ™‚ã®å³åº§å¯¾å¿œ

4. **Hono RPCã®äº’æ›æ€§ç¶­æŒ**
   - `AppType`ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã®ç¶­æŒ
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å‹æ¨è«–ã®ç¶™ç¶š
   - APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å‹•ä½œä¿è¨¼

## ğŸš€ Hono RPCäº’æ›æ€§ã‚’ç¶­æŒã—ãŸç§»è¡Œæˆ¦ç•¥

### Hono RPCã®ç¾çŠ¶åˆ†æ
```typescript
// ç¾åœ¨ã®Hono RPCè¨­å®š
// apps/api/src/index.ts
export type AppType = typeof routes;

// ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®ä½¿ç”¨
// apps/web/src/lib/rpc.ts
import { createClient } from "@repo/api";
export const client = createClient(process.env.NEXT_PUBLIC_API_URL || "http://localhost:8787");

// å‹å®‰å…¨ãªAPIå‘¼ã³å‡ºã—
// apps/web/src/services/cattleService.ts
client.api.v1.cattle.$get({ query: { ... } })
```

### Hono RPCäº’æ›æ€§ã‚’ç¶­æŒã™ã‚‹ç§»è¡Œã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

#### 1. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã§ã®Hono RPCç¶­æŒ
```typescript
// âœ… ç§»è¡Œå¾Œ: Hono RPCã‚’ç¶­æŒã—ãŸã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
// apps/api/src/interfaces/http/controllers/CattleController.ts
export const makeCattleController = (deps: ControllerDeps) => ({
  async search(c: Context): Promise<Response> {
    // æ—¢å­˜ã®Hono RPCãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¶­æŒ
    const query = c.req.valid("query");
    const result = await deps.searchCattleUseCase(query);
    
    if (!result.ok) {
      return this.handleError(c, result.error);
    }
    
    return c.json(result.value);
  }
});

// âœ… ç§»è¡Œå¾Œ: Hono RPCãƒ«ãƒ¼ãƒˆå®šç¾©ã®ç¶­æŒï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
// apps/api/src/interfaces/http/routes/cattle.ts
export const createCattleRoutes = (deps: Dependencies) => {
  const controller = makeCattleController(deps);
  
  return (app: Hono) => {
    // æ—¢å­˜ã®Hono RPCãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¶­æŒ
    app.get('/cattle', 
      zValidator("query", searchCattleSchema), 
      async (c) => controller.search(c)
    )
    
    .post('/cattle', 
      zValidator("json", createCattleSchema), 
      async (c) => controller.create(c)
    )
    
    .patch('/:id', 
      zValidator("json", updateCattleSchema), 
      async (c) => controller.update(c)
    )
    
    .delete('/:id', 
      async (c) => controller.delete(c)
    );
  };
};
```

#### 2. å¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®RPCå‹æ¨è«–ã®æœ€é©åŒ–
```typescript
// âœ… ç§»è¡Œå¾Œ: ã‚µãƒ–ãƒ«ãƒ¼ã‚¿ãƒ¼ã®åˆ†é›¢ã¨å‹æ¨è«–ã®æœ€é©åŒ–
// apps/api/src/interfaces/http/routes/cattle.ts
import { Hono } from 'hono';

const cattleApp = new Hono()
  .get('/', 
    zValidator("query", searchCattleSchema), 
    async (c) => controller.search(c)
  )
  .post('/', 
    zValidator("json", createCattleSchema), 
    async (c) => controller.create(c)
  )
  .patch('/:id', 
    zValidator("json", updateCattleSchema), 
    async (c) => controller.update(c)
  )
  .delete('/:id', 
    async (c) => controller.delete(c)
  );

export default cattleApp;

// apps/api/src/interfaces/http/routes/events.ts
const eventsApp = new Hono()
  .get('/', 
    zValidator("query", searchEventSchema), 
    async (c) => controller.search(c)
  )
  .post('/', 
    zValidator("json", createEventSchema), 
    async (c) => controller.create(c)
  );

export default eventsApp;

// apps/api/src/interfaces/http/app.ts
import { Hono } from 'hono';
import cattleApp from './routes/cattle';
import eventsApp from './routes/events';

const app = new Hono();

// ã‚µãƒ–ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’ãƒã‚§ãƒ¼ãƒ³ã—ã¦å‹æ¨è«–ã‚’æœ€é©åŒ–
const routes = app
  .route('/cattle', cattleApp)
  .route('/events', eventsApp);

export default app;
export type AppType = typeof routes; // ãƒã‚§ãƒ¼ãƒ³ã•ã‚ŒãŸãƒ«ãƒ¼ã‚¿ãƒ¼ã®å‹ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
```

#### 3. å‹å®šç¾©ã®ç¶­æŒã¨ç§»è¡Œï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
```typescript
// âœ… ç§»è¡Œå¾Œ: AppTypeã®ç¶­æŒï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
// apps/api/src/index.ts
import { createApp } from './interfaces/http/app';

const app = createApp();
export type AppType = typeof app;

// æ—¢å­˜ã®å‹ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’ç¶­æŒ
export * from "./domain/types/cattle";
export * from "./domain/types/events";
export * from "./domain/types/alerts";

// Hono RPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç¶­æŒ
export const createClient = (
  ...args: Parameters<ClientType>
): ReturnType<ClientType> => {
  return hc<AppType>(...args);
};

// å¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
// ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«å‹ã‚’è¨ˆç®—ã—ã¦IDEãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Š
export type Client = ReturnType<typeof hc<AppType>>;

export const hcWithType = (...args: Parameters<typeof hc>): Client =>
  hc<AppType>(...args);
```

#### 4. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒã®ç§»è¡Œï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
```typescript
// âœ… ç§»è¡Œå¾Œ: DTOå±¤ã§ã®ã‚¹ã‚­ãƒ¼ãƒç¶­æŒï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
// apps/api/src/application/dto/schemas/CattleSchemas.ts
export const createCattleSchema = z.object({
  identificationNumber: z.number(),
  name: z.string().optional(),
  // ... ãã®ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
});

export const searchCattleSchema = z.object({
  cursor: z.string().optional(),
  limit: z.string().optional(),
  sort_by: z.string().optional(),
  sort_order: z.string().optional(),
  search: z.string().optional(),
  growth_stage: z.string().optional(),
  gender: z.string().optional(),
  status: z.string().optional(),
  has_alert: z.string().optional(),
});

// æ—¢å­˜ã®Hono RPCãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¶­æŒ
import { createCattleSchema, searchCattleSchema } from "../../application/dto/schemas/CattleSchemas";
```

#### 5. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã®äº’æ›æ€§ç¶­æŒï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
```typescript
// âœ… ç§»è¡Œå¾Œ: æ—¢å­˜ã®APIå‘¼ã³å‡ºã—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¶­æŒ
// apps/web/src/services/cattleService.ts
export async function GetCattleList(
  queryParams: CattleListQueryParams = {}
): Promise<GetCattleListResType> {
  // æ—¢å­˜ã®Hono RPCå‘¼ã³å‡ºã—ã‚’ç¶­æŒ
  return fetchWithAuth<{ data: GetCattleListResType }>((token) =>
    client.api.v1.cattle.$get({
      query: {
        cursor: queryParams.cursor,
        limit: queryParams.limit,
        // ... ãã®ä»–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
      }
    })
  );
}

// å¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
// ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½¿ç”¨
import { hcWithType } from "@repo/api";

const optimizedClient = hcWithType(
  process.env.NEXT_PUBLIC_API_URL || "http://localhost:8787"
);
```

### Hono RPCäº’æ›æ€§ã‚’ç¶­æŒã™ã‚‹ç§»è¡Œæ‰‹é †ï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰

#### Phase 5: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ç§»è¡Œï¼ˆHono RPCç¶­æŒç‰ˆãƒ»å¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
```typescript
// 1. ã‚µãƒ–ãƒ«ãƒ¼ã‚¿ãƒ¼ã®åˆ†é›¢ï¼ˆå‹æ¨è«–ã®æœ€é©åŒ–ï¼‰
// apps/api/src/interfaces/http/routes/cattle.ts
const cattleApp = new Hono()
  .get('/', 
    zValidator("query", searchCattleSchema), 
    async (c) => controller.search(c)
  )
  .post('/', 
    zValidator("json", createCattleSchema), 
    async (c) => controller.create(c)
  )
  .patch('/:id', 
    zValidator("json", updateCattleSchema), 
    async (c) => controller.update(c)
  )
  .delete('/:id', 
    async (c) => controller.delete(c)
  );

export default cattleApp;

// 2. ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ãƒã‚§ãƒ¼ãƒ³
// apps/api/src/interfaces/http/app.ts
export const createApp = (deps: Dependencies): Hono => {
  const app = new Hono();
  
  // æ—¢å­˜ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ç¶­æŒ
  app.use("*", jwtMiddleware);
  
  // ã‚µãƒ–ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’ãƒã‚§ãƒ¼ãƒ³ã—ã¦å‹æ¨è«–ã‚’æœ€é©åŒ–
  const routes = app
    .route('/cattle', cattleApp)
    .route('/events', eventsApp)
    .route('/alerts', alertsApp)
    .route('/kpi', kpiApp);
  
  return routes;
};

// 3. AppTypeã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆãƒã‚§ãƒ¼ãƒ³ã•ã‚ŒãŸãƒ«ãƒ¼ã‚¿ãƒ¼ã®å‹ï¼‰
export type AppType = typeof routes;
```

### Hono RPCäº’æ›æ€§ç¶­æŒã®ãŸã‚ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰

#### ç§»è¡Œå®Œäº†å¾Œã®ç¢ºèªäº‹é …
- [ ] `AppType`ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹
- [ ] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å‹æ¨è«–ãŒç¶™ç¶šã—ã¦ã„ã‚‹
- [ ] `client.api.v1.*`ã®å‘¼ã³å‡ºã—ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹
- [ ] Zodãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹
- [ ] æ—¢å­˜ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå¤‰æ›´ã•ã‚Œã¦ã„ãªã„
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ãŒæ—¢å­˜ã¨ä¸€è‡´ã—ã¦ã„ã‚‹
- [ ] ã‚µãƒ–ãƒ«ãƒ¼ã‚¿ãƒ¼ã®ãƒã‚§ãƒ¼ãƒ³ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹
- [ ] IDEãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒç¶­æŒã•ã‚Œã¦ã„ã‚‹

#### ãƒ†ã‚¹ãƒˆã§ã®ç¢ºèªäº‹é …ï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
```typescript
// âœ… ç§»è¡Œå¾Œ: Hono RPCã®å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
describe('Hono RPC Compatibility (Large Application)', () => {
  it('should maintain AppType export with chained routers', () => {
    expect(typeof AppType).toBe('object');
  });

  it('should maintain existing API endpoints with sub-routers', () => {
    const app = createApp(mockDeps);
    expect(app.routes).toContainEqual(
      expect.objectContaining({
        path: '/cattle',
        method: 'GET'
      })
    );
    expect(app.routes).toContainEqual(
      expect.objectContaining({
        path: '/events',
        method: 'GET'
      })
    );
  });

  it('should maintain validation schemas across sub-routers', () => {
    expect(createCattleSchema).toBeDefined();
    expect(searchCattleSchema).toBeDefined();
    expect(createEventSchema).toBeDefined();
  });

  it('should optimize type inference with chained routers', () => {
    // ãƒã‚§ãƒ¼ãƒ³ã•ã‚ŒãŸãƒ«ãƒ¼ã‚¿ãƒ¼ã®å‹æ¨è«–ãŒæœ€é©åŒ–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
    const routes = app.route('/cattle', cattleApp).route('/events', eventsApp);
    expect(typeof routes).toBe('object');
  });
});
```

### Hono RPCäº’æ›æ€§ç¶­æŒã®åˆ©ç‚¹ï¼ˆå¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰

#### é–‹ç™ºåŠ¹ç‡ã®ç¶­æŒ
1. **å‹å®‰å…¨æ€§ã®ç¶™ç¶š**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®å‹æ¨è«–ãŒç¶™ç¶š
2. **é–‹ç™ºä½“é¨“ã®ç¶­æŒ**: æ—¢å­˜ã®APIå‘¼ã³å‡ºã—ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç¶™ç¶š
3. **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®å®‰å…¨æ€§**: å‹ãƒã‚§ãƒƒã‚¯ã«ã‚ˆã‚‹å®‰å…¨æ€§ç¢ºä¿
4. **IDEãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æœ€é©åŒ–**: ã‚µãƒ–ãƒ«ãƒ¼ã‚¿ãƒ¼åˆ†é›¢ã«ã‚ˆã‚‹å‹æ¨è«–ã®æœ€é©åŒ–

#### ç§»è¡Œãƒªã‚¹ã‚¯ã®æœ€å°åŒ–
1. **æ®µéšçš„ç§»è¡Œ**: Hono RPCã‚’ç¶­æŒã—ãªãŒã‚‰å†…éƒ¨æ§‹é€ ã‚’å¤‰æ›´
2. **æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®ä¿è­·**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ä¸è¦
3. **å‹•ä½œä¿è¨¼**: æ—¢å­˜ã®APIå¥‘ç´„ã‚’ç¶­æŒ
4. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¶­æŒ**: å¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®IDEãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¶­æŒ

#### å°†æ¥ã®æ‹¡å¼µæ€§
1. **Hono RPCã®é€²åŒ–**: æ–°ã—ã„Hono RPCæ©Ÿèƒ½ã®æ´»ç”¨
2. **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æŸ”è»Ÿæ€§**: å†…éƒ¨æ§‹é€ ã®æ”¹å–„ã¨APIäº’æ›æ€§ã®ä¸¡ç«‹
3. **æ®µéšçš„æ”¹å–„**: ç¶™ç¶šçš„ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ”¹å–„ãŒå¯èƒ½
4. **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: å¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®åŠ¹ç‡çš„ãªå‹æ¨è«–

### å¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®Hono RPCæœ€é©åŒ–æˆ¦ç•¥

#### 1. ã‚µãƒ–ãƒ«ãƒ¼ã‚¿ãƒ¼ã®åˆ†é›¢
```typescript
// å„ãƒ‰ãƒ¡ã‚¤ãƒ³ã”ã¨ã«ã‚µãƒ–ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’ä½œæˆ
// apps/api/src/interfaces/http/routes/cattle.ts
const cattleApp = new Hono()
  .get('/', ...)
  .post('/', ...);

// apps/api/src/interfaces/http/routes/events.ts
const eventsApp = new Hono()
  .get('/', ...)
  .post('/', ...);

// ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒã‚§ãƒ¼ãƒ³
const routes = app
  .route('/cattle', cattleApp)
  .route('/events', eventsApp);
```

#### 2. å‹æ¨è«–ã®æœ€é©åŒ–
```typescript
// ãƒã‚§ãƒ¼ãƒ³ã•ã‚ŒãŸãƒ«ãƒ¼ã‚¿ãƒ¼ã®å‹ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
export type AppType = typeof routes;

// ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã®å‹è¨ˆç®—ã«ã‚ˆã‚‹IDEãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š
export type Client = ReturnType<typeof hc<AppType>>;
export const hcWithType = (...args: Parameters<typeof hc>): Client =>
  hc<AppType>(...args);
```

#### 3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æœ€é©åŒ–
```typescript
// ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½¿ç”¨
const optimizedClient = hcWithType('http://localhost:8787/');

// ã‚µãƒ–ãƒ«ãƒ¼ã‚¿ãƒ¼ã”ã¨ã®å€‹åˆ¥ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚‚å¯èƒ½
const cattleClient = hc<typeof cattleApp>('/cattle');
const eventsClient = hc<typeof eventsApp>('/events');
```

ã“ã®æˆ¦ç•¥ã«ã‚ˆã‚Šã€Hono RPCã®åˆ©ç‚¹ã‚’ç¶­æŒã—ãªãŒã‚‰ã€å¤§ããªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã¨ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¸ã®ç§»è¡Œã‚’å®Ÿç¾ã§ãã¾ã™ã€‚
---
